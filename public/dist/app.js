!function(){"use strict";angular.module("miniRvce",["ui.router","toaster","ngAnimate"]).config(["$stateProvider","$urlRouterProvider","$httpProvider",function(t,n,e){n.otherwise("/home");var o="src/";t.state("account",{url:"/user",templateUrl:o+"user/account/account.tpl",controller:"AccountController as account"}).state("account.login",{url:"/user/login",templateUrl:o+"user/account/login/login.tpl",controller:"LoginController as login"}).state("account.signup",{url:"/user/signup",templateUrl:o+"user/account/signup/signup.tpl",controller:"SignUpController as signup"}).state("account.logout",{url:"/user/login",templateUrl:o+"user/account/login/login.tpl",controller:"AccountController as account"}).state("home",{url:"/home",templateUrl:o+"home/home.tpl",controller:"HomeController as home"}).state("question",{url:"/question/:ques_id",templateUrl:o+"questions/question.tpl",controller:"QuestionController as question"}).state("listed",{url:"/listed/:tag_id",templateUrl:o+"listed/tagList.tpl",controller:"tagListController as listed"}).state("addques",{url:"/addques",templateUrl:o+"addques/addques.tpl",controller:"AddQuesController as addques"}).state("unanswered",{url:"/unanswered",templateUrl:o+"unanswered/unanswered.tpl",controller:"UnansweredController as unaswered"})}])}(),function(){"use strict";angular.module("miniRvce").controller("AddQuesController",["$scope","$state","$rootScope","$window","$stateParams","AddQues","Tag",function(t,n,e,o,u,a,c){var r=this;r.user=null,e.verifiedAcc=o.localStorage.getItem("vfd"),r.tagsList=[],c.getTags().then(function(t){r.tagsList=t.data.TAGS}).catch(function(t){console.log("Tag retrieval error: ",t)}),r.user=o.localStorage.getItem("user_id"),r.uname=o.localStorage.getItem("name"),r.col_id=o.localStorage.getItem("cl_id"),r.tag_id=null,r.tag_name=null;var i=new Date;r.cur_date=("0"+i.getDate()).slice(-2)+"-"+("0"+(i.getMonth()+1)).slice(-2)+"-"+i.getFullYear();var s={};r.getTag=function(){r.tag_id=t.item.id,console.log("tag_id ",r.tag_id),r.tag_name=t.item.name},r.addQuestion=function(){console.log("tag_id ",r.tag_id),s={tag_id:r.tag_id,tag:r.tag_name,u_id:r.user,col_id:r.col_id,contents:r.new_ques,username:r.uname,pdate:r.cur_date},a.postQues(s).then(function(t){n.go("home")}).catch(function(t){console.log("Error in posting question",t)})}}])}(),function(){"use strict";angular.module("miniRvce").factory("AddQues",["$http","$window",function(t,n){return{postQues:function(n){return t.post("/question",n)}}}])}(),function(){"use strict";angular.module("miniRvce").controller("CommentController",["$rootScope","$window","$stateParams","Comment",function(t,n,e,o){var u=this;u.commentList=[],u.user=null,u.user=n.localStorage.getItem("user_id"),t.verifiedAcc=n.localStorage.getItem("vfd"),u.uname=n.localStorage.getItem("name"),u.new_comment=null,u.cur_a_id=null,u.upd=function(t){o.getComments(t).then(function(t){console.log("comments: ",t),u.commentList=t.data.COMMENTS}).catch(function(t){console.log(t)})},u.addComment=function(t){var n={u_id:u.user,ans_id:t,contents:u.new_comment,uname:u.uname};o.postComm(n).then(function(n){u.upd(t)}).catch(function(t){console.log("Error in posting comment: ",t)})}}])}(),function(){"use strict";angular.module("miniRvce").factory("Comment",["$http","$window",function(t,n){return{getComments:function(n){return t.get("/comments/?ans_id="+n)},postComm:function(n){return t.post("/comments",n)}}}])}(),function(){"use strict";angular.module("miniRvce").controller("HomeController",["$state","$http","Home","$window","$stateParams","$rootScope","Question","Comment",function(t,n,e,o,u,a,c,r){var i=this;i.tagsList=[],i.queslist=[];a.verifiedAcc=o.localStorage.getItem("vfd");var s=function(t){var n=c.getAnswers(t).then(function(t){return t.data.ANSWERS[0]}).catch(function(t){return t});return n},l=function(t){var n=r.getComments(t).then(function(t){return t.data.COMMENTS}).catch(function(t){return t});return n};i.getall=function(){return e.getQuestions().then(function(t){i.queslist=t.data.QUESTION;for(var n=0;n<i.queslist.length;n++)i.queslist[n].topAns=s(i.queslist[n].id).then(function(t){return console.log("getTopAns: ",t),t}).catch(function(t){console.log(t)})}).catch(function(t){console.log("error:",t)}),1},i.getCom=function(){for(var t=0;t<i.queslist.length;t++)console.log("aaaa"),i.queslist[t].topAns.topCom=l(i.queslist[t].topAns.$$state.value.id).then(function(t){return console.log(t),t}).catch(function(t){console.log(t)})},i.sequence=function(){return i.getall()},i.sequence(),i.popQues=[],e.getPopularQues().then(function(t){console.log("aaaaaaaaaaaa",t),i.popQues=t.data.QUESTION}).catch(function(t){console.log("popular fetch error: ",t)}),i.update_up=function(t){e.upd_up(t).then(function(t){i.getall()}).catch(function(t){console.log(t)})},i.update_dw=function(t){e.upd_dw(t).then(function(t){i.getall()}).catch(function(t){console.log(t)})},e.getTags().then(function(t){i.tagsList=t.data.TAGS}).catch(function(t){console.log("Tag retrieval error: ",t)})}])}(),function(){"use strict";angular.module("miniRvce").factory("Home",["$http","$window",function(t,n){return{getQuestions:function(){return t.get("/question/all")},getTags:function(){return t.get("/tags")},upd_up:function(n){return t.post("/question/up",{q_id:n})},upd_dw:function(n){return t.post("/question/dw",{q_id:n})},getPopularQues:function(){return t.get("/question/popular")}}}])}(),function(){"use strict";angular.module("miniRvce").controller("TagController",["$state","$http","Tag","$window","$stateParams","$rootScope",function(t,n,e,o,u,a){var c=this;c.tagsList=[],a.verifiedAcc=o.localStorage.getItem("vfd"),e.getTags().then(function(t){c.tagsList=t.data.TAGS}).catch(function(t){console.log("Tag retrieval error: ",t)})}])}(),function(){"use strict";angular.module("miniRvce").factory("Tag",["$http","$window",function(t,n){return{getTags:function(){return t.get("/tags")}}}])}(),function(){"use strict";angular.module("miniRvce").controller("UnansweredController",["$state","$http","Home","$window","$stateParams","$rootScope",function(t,n,e,o,u,a){var c=this;c.tagsList=[],c.queslist=[],a.verifiedAcc=o.localStorage.getItem("vfd"),c.getall=function(){e.getQuestions().then(function(t){c.queslist=t.data.QUESTION}).catch(function(t){console.log("error:",t)})},c.getall(),c.update_up=function(t){e.upd_up(t).then(function(t){c.getall()}).catch(function(t){console.log(t)})},c.update_dw=function(t){e.upd_dw(t).then(function(t){c.getall()}).catch(function(t){console.log(t)})},e.getTags().then(function(t){c.tagsList=t.data.TAGS}).catch(function(t){console.log("Tag retrieval error: ",t)})}])}(),function(){"use strict";angular.module("miniRvce").controller("AccountController",["Account","$state","$window","$rootScope",function(t,n,e,o){var u=this;o.loggedIn=t.isLoggedInFunc(),o.verifiedAcc=t.isVerified(),u.logout=function(){t.logout(),u.loggedin=!1}}])}(),function(){"use strict";angular.module("miniRvce").factory("Account",["$http","$window",function(t,n){function e(n){return t.post("/signup",n)}function o(){return 1===n.localStorage.getItem("vfd")}function u(e){var o=this;return t.post("/login",e).then(function(t){o.isLoggedIn=!0,l=t.data.token,g=t.data.USER[0].id;var e=t.data.USER[0].dept_id;return n.localStorage.setItem("token",l),n.localStorage.setItem("user_id",g),n.localStorage.setItem("d_id",e),n.localStorage.setItem("cl_id",t.data.USER[0].col_id),n.localStorage.setItem("name",t.data.USER[0].name),n.localStorage.setItem("usn",t.data.USER[0].usn),n.localStorage.setItem("email",t.data.USER[0].email),n.localStorage.setItem("phone",t.data.USER[0].phone),n.localStorage.setItem("type",t.data.USER[0].type),n.localStorage.setItem("vfd",t.data.USER[0].verified),t}).catch(function(t){console.log(t)})}function a(){return d=!1,n.localStorage.clear()}function c(){return s()&&i()?(d=!0,!0):(console.log("not logged in"),d=!1,!1)}function r(){return t.get("/users")}function i(){return g=n.localStorage.getItem("user_id")}function s(){return l=n.localStorage.getItem("token")}var l=null,g=null,d=!1;return{signUp:e,login:u,getUserNames:r,getUserId:i,getToken:s,isLoggedIn:this.isLoggedIn,isLoggedInFunc:c,logout:a,isVerified:o}}])}(),function(){"use strict";angular.module("miniRvce").controller("QuestionController",["$rootScope","$window","$stateParams","Question",function(t,n,e,o){var u=this;u.answerList=[],u.curQuestionId=e.ques_id,u.new_answer=null,u.user=null,u.user=n.localStorage.getItem("user_id"),t.verifiedAcc=n.localStorage.getItem("vfd");var a=u.curQuestionId,c=function(){o.getCurDet(a).then(function(t){console.log(t),u.allData=t.data.QUESTION}).catch(function(t){console.log(t)})};c();var r=function(){o.getAnswers(u.curQuestionId).then(function(t){console.log("answers: ",t),u.answerList=t.data.ANSWERS}).catch(function(t){console.log(t)})};r(),u.addAnswer=function(){var t={u_id:u.user,q_id:u.curQuestionId,contents:u.new_answer};o.postAns(t).then(function(t){r()}).catch(function(t){console.log("Error in posting answer",t)})},u.update_up=function(t){o.upd_up(t).then(function(t){console.log(t)}).catch(function(t){console.log(t)})},u.update_dw=function(t){o.upd_dw(t).then(function(t){console.log(t)}).catch(function(t){console.log(t)})}}])}(),function(){"use strict";angular.module("miniRvce").factory("Question",["$http","$window",function(t,n){return{getAnswers:function(n){return t.get("/answer/?id="+n)},getCurDet:function(n){return t.get("/question/qid/?q_id="+n)},postAns:function(n){return t.post("/answer",n)},upd_up:function(n){return t.post("/answer/up",{a_id:n})},upd_dw:function(n){return t.post("/answer/dw",{a_id:n})}}}])}(),function(){"use strict";angular.module("miniRvce").controller("tagListController",["$state","$http","Home","tagList","$window","$stateParams","$rootScope",function(t,n,e,o,u,a,c){var r=this;r.queslist=[],r.t_id=a.tag_id,c.verifiedAcc=u.localStorage.getItem("vfd"),o.getQuestions(r.t_id).then(function(t){r.queslist=t.data.QUESTION}).catch(function(t){console.log("error:",t)}),r.update_up=function(t){e.upd_up(t).then(function(t){}).catch(function(t){console.log(t)})},r.update_dw=function(t){e.upd_dw(t).then(function(t){}).catch(function(t){console.log(t)})}}])}(),function(){"use strict";angular.module("miniRvce").factory("tagList",["$http","$window",function(t,n){return{getQuestions:function(n){return t.get("/question/?tag_id="+n)}}}])}(),function(){"use strict";angular.module("miniRvce").controller("LoginController",["$window","Account","$state","$rootScope",function(t,n,e,o){var u=this;o.isSignUp=!1,u.submit=function(){n.login({usn:u.usn,password:u.password}).then(function(n){console.log(n),n.data.error?u.Message=n.data.error:(o.loggedIn=!0,o.verifiedAcc=t.localStorage.getItem("vfd"),e.go("home"))}).catch(function(t){console.log(t),u.Message=t})}}])}(),function(){"use strict";angular.module("miniRvce").controller("SignUpController",["Account","$state","$rootScope",function(t,n,e){var o=this;o.message="",o.enable=!1,e.isSignUp=!0,o.submit=function(){console.log(o);var e={dept_name:o.dept_name,clg_name:o.clg_name,name:o.name,usn:o.usn,password:o.password,email:o.email,phone:o.phone,type:o.typ};o.message="",t.signUp(e).then(function(o){console.log("Response after signin up: ",o),t.login({usn:e.usn,password:e.password}).then(function(){n.go("home")}).catch(function(t){console.log("err During login!!"),console.log(t)})}).catch(function(t){o.enable=!0,o.message="Unsuccessful!! Please Check the entered details..!",console.log("err during signup: ",t)})}}])}();